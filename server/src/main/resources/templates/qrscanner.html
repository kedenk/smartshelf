<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
 
<body layout:fragment="content">
 
<!-- Main jumbotron for a primary marketing message or call to action -->
<div class="jumbotron" th:fragment="content">
	<div class="row col-md-6 col-md-offset-3">
		<div class="panel panel-primary">
		  <div class="panel-heading"><h4>QR-Code Scanner</h4></div>
		  <div class="panel-body">
		  	Scan the QR-Code on a box to get more information about the contained item.
		  </div>
		</div>	
		
        <div class="qrscanner col-md-6" id="scanner">
        </div>
    </div>

    <script th:inline="javascript">
    
 		function getInformaton( boxid ) {
 			
 			console.log("Fetching data for " + boxid);
 			
 			window.location.href="http://" + [[${serverurl}]] + ':' + [[${@environment.getProperty('server.port')}]] + "/qrscanner/info/box/" + boxid;
 		}
 		
        function onQRCodeScanned(scannedText)
        {
            // scannedText is the value for the input QR image.
            console.log("Scanned QR-Code: ", scannedText);
            
            getInformaton(scannedText);
        }

        //this function will be called when JsQRScanner is ready to use
        function JsQRScannerReady()
        {
            //create a new scanner passing to it a callback function that will be invoked when
            //the scanner succesfully scan a QR code
            var jbScanner = new JsQRScanner(onQRCodeScanned);
            //reduce the size of analyzed image to increase performance on mobile devices
            jbScanner.setSnapImageMaxSize(300);
            var scannerParentElement = document.getElementById("scanner");
            if(scannerParentElement)
            {
                //append the jbScanner to an existing DOM element
                jbScanner.appendTo(scannerParentElement);
            }
        }
    </script>
</div>
 
 

</body>
</html>
